<?xml version="1.0" encoding="UTF-8" ?>
<Application xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Mauixui.Converters"
             x:Class="Mauixui.App">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Colors.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <!-- Конвертеры -->
            <converters:NoteColorConverter x:Key="NoteColorConverter" />
            <converters:InverseBooleanConverter x:Key="NotConverter" />

            <!-- Шаблон для заметок -->
            <DataTemplate x:Key="NoteItemTemplate">
                <Frame BackgroundColor="{Binding Color, Converter={x:StaticResource NoteColorConverter}}"
                       CornerRadius="12"
                       Padding="15"
                       Margin="5"
                       HasShadow="True">
                    <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="*,Auto">

                        <!-- Заголовок и пин -->
                        <Label Grid.Row="0" Grid.Column="0"
                               Text="{Binding Title}"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="{StaticResource TextDark}"
                               LineBreakMode="TailTruncation"/>

                        <Label Grid.Row="0" Grid.Column="1"
                               Text="📌"
                               IsVisible="{Binding IsPinned}"
                               FontSize="12"/>

                        <!-- Контент -->
                        <Label Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                               Text="{Binding Preview}"
                               FontSize="13"
                               TextColor="{StaticResource TextSecondaryDark}"
                               LineBreakMode="TailTruncation"
                               MaxLines="3"/>

                        <!-- Теги и дата -->
                        <HorizontalStackLayout Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                                               Spacing="5">
                            <CollectionView ItemsSource="{Binding Tags}"
                                            HorizontalScrollBarVisibility="Never"
                                            HeightRequest="20">
                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="5"/>
                                </CollectionView.ItemsLayout>
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Frame BackgroundColor="{StaticResource AccentDark}"
                                               CornerRadius="8"
                                               Padding="5,2"
                                               HasShadow="False">
                                            <Label Text="{Binding .}"
                                                   FontSize="9"
                                                   TextColor="{StaticResource White}"/>
                                        </Frame>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                            <Label Text="{Binding ModifiedAt, StringFormat='{0:dd.MM.yy}'}"
                                   FontSize="10"
                                   TextColor="{StaticResource TextSecondaryDark}"
                                   HorizontalOptions="EndAndExpand"/>
                        </HorizontalStackLayout>

                    </Grid>
                </Frame>
            </DataTemplate>

        </ResourceDictionary>
    </Application.Resources>
</Application>