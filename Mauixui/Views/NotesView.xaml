<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Mauixui.Views.NotesView">

    <Grid ColumnDefinitions="300,*" ColumnSpacing="15" Padding="15">

        <!-- Ð›ÐµÐ²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ - Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ -->
        <ScrollView Grid.Column="0">
            <VerticalStackLayout Spacing="15">

                <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
                <Label Text="ÐÐ¾Ð²Ð°Ñ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ°" 
                       FontSize="20" 
                       FontAttributes="Bold"
                       TextColor="{StaticResource TextDark}"
                       HorizontalOptions="Center"/>

                <!-- ÐŸÐ¾Ð»Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ° -->
                <Frame BackgroundColor="{StaticResource TertiaryDark}"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="False">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº" 
                               FontSize="12" 
                               TextColor="{StaticResource TextSecondaryDark}"/>
                        <Entry x:Name="TitleEntry"
                               Placeholder="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº..."
                               TextColor="{StaticResource TextDark}"
                               BackgroundColor="Transparent"
                               FontSize="16"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Ð ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ -->
                <Frame BackgroundColor="{StaticResource TertiaryDark}"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="False">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ" 
                               FontSize="12" 
                               TextColor="{StaticResource TextSecondaryDark}"/>
                        <Editor x:Name="ContentEditor"
                                Placeholder="ÐÐ°Ñ‡Ð½Ð¸Ñ‚Ðµ Ð¿Ð¸ÑÐ°Ñ‚ÑŒ..."
                                TextColor="{StaticResource TextDark}"
                                BackgroundColor="Transparent"
                                MinimumHeightRequest="150"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Ð£Ð¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² -->
                <Frame BackgroundColor="{StaticResource TertiaryDark}"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="False">
                    <VerticalStackLayout Spacing="10">
                        <Label Text="Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ" 
                               FontSize="12" 
                               TextColor="{StaticResource TextSecondaryDark}"/>

                        <HorizontalStackLayout Spacing="8">
                            <Button Text="ðŸ“Œ Ð—Ð°ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ" 
                                    Clicked="TogglePin"
                                    BackgroundColor="{StaticResource SecondaryDark}"
                                    TextColor="{StaticResource TextDark}"
                                    CornerRadius="8"
                                    FontSize="12"/>
                            <Button Text="ðŸ·ï¸ Ð¢ÐµÐ³Ð¸" 
                                    Clicked="AddTag"
                                    BackgroundColor="{StaticResource SecondaryDark}"
                                    TextColor="{StaticResource TextDark}"
                                    CornerRadius="8"
                                    FontSize="12"/>
                            <Button Text="ðŸŽ¨ Ð¦Ð²ÐµÑ‚" 
                                    Clicked="ShowColorPicker"
                                    BackgroundColor="{StaticResource SecondaryDark}"
                                    TextColor="{StaticResource TextDark}"
                                    CornerRadius="8"
                                    FontSize="12"/>
                        </HorizontalStackLayout>

                        <!-- Ð¢ÐµÐ³Ð¸ -->
                        <FlexLayout x:Name="TagsContainer" 
                                    Wrap="Wrap" 
                                    AlignItems="Start"
                                    BindableLayout.ItemsSource="{Binding CurrentTags}">
                            <BindableLayout.ItemTemplate>
                                <DataTemplate>
                                    <Frame BackgroundColor="{StaticResource AccentDark}"
                                           CornerRadius="12"
                                           Padding="8,4"
                                           Margin="2">
                                        <Label Text="{Binding .}" 
                                               FontSize="10" 
                                               TextColor="{StaticResource White}"/>
                                    </Frame>
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </FlexLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <Button  x:Name="SaveButton"
                            Grid.Column="0"
                            Text="ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"
                            Clicked="SaveNote"
                            BackgroundColor="{StaticResource AccentDark}"
                            TextColor="{StaticResource White}"
                            CornerRadius="10"
                            HeightRequest="45"/>
                    <Button Grid.Column="1"
                            Text="ðŸ”„ ÐÐ¾Ð²Ñ‹Ð¹"
                            Clicked="NewNote"
                            BackgroundColor="{StaticResource TertiaryDark}"
                            TextColor="{StaticResource TextDark}"
                            CornerRadius="10"
                            HeightRequest="45"/>
                </Grid>

                <!-- Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº -->
                <Frame BackgroundColor="{StaticResource TertiaryDark}"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="False">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸" 
                               FontSize="12" 
                               TextColor="{StaticResource TextSecondaryDark}"/>

                        <Button Text="ðŸ“¤ Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº" 
                                Clicked="ExportNotes"
                                BackgroundColor="{StaticResource SecondaryDark}"
                                TextColor="{StaticResource TextDark}"
                                CornerRadius="8"
                                HeightRequest="35"/>
                        <Button Text="ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ°" 
                                Clicked="CreateQuickNote"
                                BackgroundColor="{StaticResource SecondaryDark}"
                                TextColor="{StaticResource TextDark}"
                                CornerRadius="8"
                                HeightRequest="35"/>
                        <Button Text="ðŸ” ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ñ‚ÐµÐ³Ð°Ð¼" 
                                Clicked="SearchByTag"
                                BackgroundColor="{StaticResource SecondaryDark}"
                                TextColor="{StaticResource TextDark}"
                                CornerRadius="8"
                                HeightRequest="35"/>
                    </VerticalStackLayout>
                </Frame>

            </VerticalStackLayout>
        </ScrollView>

        <!-- ÐŸÑ€Ð°Ð²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ - ÑÐ¿Ð¸ÑÐ¾Ðº Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº -->
        <Grid Grid.Column="1" RowDefinitions="Auto,*">

            <!-- ÐŸÐ°Ð½ÐµÐ»ÑŒ Ð¿Ð¾Ð¸ÑÐºÐ° Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð² -->
            <Frame Grid.Row="0"
                   BackgroundColor="{StaticResource TertiaryDark}"
                   CornerRadius="10"
                   Padding="15"
                   HasShadow="False"
                   Margin="0,0,0,15">
                <VerticalStackLayout Spacing="10">
                    <SearchBar x:Name="SearchBar"
                               Placeholder="ÐŸÐ¾Ð¸ÑÐº Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº..."
                               TextChanged="OnSearchChanged"
                               BackgroundColor="Transparent"
                               TextColor="{StaticResource TextDark}"
                               PlaceholderColor="{StaticResource TextSecondaryDark}"/>

                    <!-- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ -->
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <ScrollView Orientation="Horizontal" Grid.Column="0">
                            <HorizontalStackLayout Spacing="8">
                                <Button Text="Ð’ÑÐµ" 
                                        Clicked="FilterAll"
                                        BackgroundColor="{StaticResource AccentDark}"
                                        TextColor="{StaticResource White}"
                                        CornerRadius="15"
                                        HeightRequest="30"/>
                                <Button Text="ðŸ“Œ Ð—Ð°ÐºÑ€ÐµÐ¿Ð»ÐµÐ½Ð½Ñ‹Ðµ" 
                                        Clicked="FilterPinned"
                                        BackgroundColor="{StaticResource SecondaryDark}"
                                        TextColor="{StaticResource TextDark}"
                                        CornerRadius="15"
                                        HeightRequest="30"/>
                                <Button Text="ðŸ”„ ÐÐµÐ´Ð°Ð²Ð½Ð¸Ðµ" 
                                        Clicked="FilterRecent"
                                        BackgroundColor="{StaticResource SecondaryDark}"
                                        TextColor="{StaticResource TextDark}"
                                        CornerRadius="15"
                                        HeightRequest="30"/>
                                <Button Text="ðŸ”¤ ÐŸÐ¾ Ð°Ð»Ñ„Ð°Ð²Ð¸Ñ‚Ñƒ" 
                                        Clicked="SortAlphabetically"
                                        BackgroundColor="{StaticResource SecondaryDark}"
                                        TextColor="{StaticResource TextDark}"
                                        CornerRadius="15"
                                        HeightRequest="30"/>
                                <Button Text="âœ… Ð—Ð°Ð´Ð°Ñ‡Ð¸" 
                                        Clicked="FilterTasks"
                                        BackgroundColor="{StaticResource SuccessGreen}"
                                        TextColor="{StaticResource White}"
                                        CornerRadius="15"
                                        HeightRequest="30"/>
                            </HorizontalStackLayout>
                        </ScrollView>

                        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ¸ -->
                        <Button x:Name="DeleteButton"
                                Grid.Column="1"
                                Text="ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"
                                Clicked="DeleteSelectedNote"
                                BackgroundColor="{StaticResource ErrorRed}"
                                TextColor="{StaticResource White}"
                                CornerRadius="15"
                                HeightRequest="30"
                                IsVisible="False"/>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð·Ð°Ð¼ÐµÑ‚Ð¾Ðº -->
            <RefreshView Grid.Row="1"
                         x:Name="NotesRefreshView"
                         RefreshColor="{StaticResource AccentDark}"
                         Command="{Binding RefreshNotesCommand}">
                <ScrollView>
                    <VerticalStackLayout x:Name="NotesContainer" Spacing="15" Padding="0,0,5,0"/>
                </ScrollView>
            </RefreshView>

        </Grid>

    </Grid>

</ContentView>